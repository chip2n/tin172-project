<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>src/Shrdlite/AStar.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>Shrdlite</span><span class='hs-varop'>.</span><span class='hs-conid'>AStar</span> <span class='hs-layout'>(</span>
<a name="line-2"></a>   <span class='hs-comment'>-- * Dataypes</span>
<a name="line-3"></a>     <span class='hs-conid'>AStarState</span>
<a name="line-4"></a>
<a name="line-5"></a>   <span class='hs-comment'>-- * Functions</span>
<a name="line-6"></a>   <span class='hs-layout'>,</span> <span class='hs-varid'>aStar</span>
<a name="line-7"></a>   <span class='hs-layout'>,</span> <span class='hs-varid'>aStar'</span>
<a name="line-8"></a>   <span class='hs-layout'>,</span> <span class='hs-varid'>resultList</span>
<a name="line-9"></a>   <span class='hs-layout'>,</span> <span class='hs-varid'>stateTrans</span>
<a name="line-10"></a>   <span class='hs-layout'>,</span> <span class='hs-varid'>updateState</span>
<a name="line-11"></a><span class='hs-layout'>)</span>
<a name="line-12"></a><span class='hs-keyword'>where</span>
<a name="line-13"></a>
<a name="line-14"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Maybe</span>
<a name="line-15"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>PSQueue</span> <span class='hs-layout'>(</span><span class='hs-conid'>Binding</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-16"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Shrdlite</span><span class='hs-varop'>.</span><span class='hs-conid'>Common</span>
<a name="line-17"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>M</span>
<a name="line-18"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>PSQueue</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Q</span>
<a name="line-19"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Set</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>S</span>
<a name="line-20"></a>
<a name="line-21"></a><a name="AStarState"></a><span class='hs-comment'>-- | The current state of the algoritm. Closed nodes are visited, open is a</span>
<a name="line-22"></a><a name="AStarState"></a><span class='hs-comment'>-- queue of nodes to visit, pathCost keeps track of the cost of getting to each</span>
<a name="line-23"></a><a name="AStarState"></a><span class='hs-comment'>-- node and parent is a map from each node to its parent or previous node.</span>
<a name="line-24"></a><a name="AStarState"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>AStarState</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>AStarState</span> <span class='hs-layout'>{</span> <span class='hs-varid'>closed</span>   <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-varop'>.</span><span class='hs-conid'>Set</span> <span class='hs-conid'>WorldHolding</span><span class='hs-layout'>)</span>
<a name="line-25"></a>                             <span class='hs-layout'>,</span> <span class='hs-varid'>open</span>     <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-layout'>(</span><span class='hs-conid'>Q</span><span class='hs-varop'>.</span><span class='hs-conid'>PSQ</span> <span class='hs-conid'>WorldHolding</span> <span class='hs-conid'>Int</span><span class='hs-layout'>)</span>
<a name="line-26"></a>                             <span class='hs-layout'>,</span> <span class='hs-varid'>pathCost</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-conid'>WorldHolding</span> <span class='hs-conid'>Int</span><span class='hs-layout'>)</span>
<a name="line-27"></a>                             <span class='hs-layout'>,</span> <span class='hs-varid'>parent</span>   <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-conid'>WorldHolding</span> <span class='hs-conid'>WorldHolding</span><span class='hs-layout'>)</span><span class='hs-layout'>}</span>
<a name="line-28"></a>
<a name="line-29"></a><a name="aStar"></a><span class='hs-comment'>-- | Find the best path from the initial node to (one of) the goal state(s).</span>
<a name="line-30"></a><span class='hs-comment'>-- Gives this in the form of a 'Plan'.</span>
<a name="line-31"></a><span class='hs-definition'>aStar</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>WorldHolding</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>S</span><span class='hs-varop'>.</span><span class='hs-conid'>Set</span> <span class='hs-conid'>WorldHolding</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- ^ Graph to search through</span>
<a name="line-32"></a>      <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>WorldHolding</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-layout'>)</span>                <span class='hs-comment'>-- ^ Heuristic distance to the goal</span>
<a name="line-33"></a>      <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>WorldHolding</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span>               <span class='hs-comment'>-- ^ Goal check function</span>
<a name="line-34"></a>      <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WorldHolding</span>                         <span class='hs-comment'>-- ^ Starting point</span>
<a name="line-35"></a>      <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Plan</span>                           <span class='hs-comment'>-- ^ Resulting path if it exists</span>
<a name="line-36"></a><span class='hs-definition'>aStar</span> <span class='hs-varid'>graph</span> <span class='hs-varid'>heur</span> <span class='hs-varid'>check</span> <span class='hs-varid'>start</span> <span class='hs-keyglyph'>=</span>
<a name="line-37"></a>    <span class='hs-varid'>aStar'</span> <span class='hs-varid'>initState</span> <span class='hs-varid'>graph</span> <span class='hs-varid'>heur</span> <span class='hs-varid'>check</span>
<a name="line-38"></a>  <span class='hs-keyword'>where</span> <span class='hs-varid'>initState</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>AStarState</span> <span class='hs-layout'>{</span><span class='hs-varid'>closed</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-varop'>.</span><span class='hs-varid'>empty</span><span class='hs-layout'>,</span>
<a name="line-39"></a>                                <span class='hs-varid'>open</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Q</span><span class='hs-varop'>.</span><span class='hs-varid'>singleton</span> <span class='hs-varid'>start</span> <span class='hs-layout'>(</span><span class='hs-varid'>heur</span> <span class='hs-varid'>start</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-40"></a>                                <span class='hs-varid'>pathCost</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>singleton</span> <span class='hs-varid'>start</span> <span class='hs-num'>0</span><span class='hs-layout'>,</span>
<a name="line-41"></a>                                <span class='hs-varid'>parent</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>empty</span><span class='hs-layout'>}</span>
<a name="line-42"></a>
<a name="line-43"></a><a name="aStar'"></a><span class='hs-comment'>-- | Much like 'aStar', but also takes an initial state</span>
<a name="line-44"></a><span class='hs-definition'>aStar'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>AStarState</span>                            <span class='hs-comment'>-- ^ Initial state</span>
<a name="line-45"></a>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>WorldHolding</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>S</span><span class='hs-varop'>.</span><span class='hs-conid'>Set</span> <span class='hs-conid'>WorldHolding</span><span class='hs-layout'>)</span>  <span class='hs-comment'>-- ^ Graph to search through</span>
<a name="line-46"></a>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>WorldHolding</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-layout'>)</span>                 <span class='hs-comment'>-- ^ Heuristic distance to the goal</span>
<a name="line-47"></a>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>WorldHolding</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span>                <span class='hs-comment'>-- ^ Goal check function</span>
<a name="line-48"></a>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Plan</span>                            <span class='hs-comment'>-- ^ Resulting path if it exists</span>
<a name="line-49"></a><span class='hs-definition'>aStar'</span> <span class='hs-varid'>s</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-conid'>Q</span><span class='hs-varop'>.</span><span class='hs-varid'>minView</span> <span class='hs-varop'>$</span> <span class='hs-varid'>open</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span> <span class='hs-comment'>-- take best open node</span>
<a name="line-50"></a>    <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>node</span> <span class='hs-conop'>:-&gt;</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>open'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>       <span class='hs-comment'>-- the chosen node and updated open queue</span>
<a name="line-51"></a>        <span class='hs-keyword'>if</span> <span class='hs-varid'>c</span> <span class='hs-varid'>node</span>                     <span class='hs-comment'>-- the goal is found</span>
<a name="line-52"></a>          <span class='hs-keyword'>then</span> <span class='hs-conid'>Just</span> <span class='hs-varop'>$</span> <span class='hs-varid'>resultList</span> <span class='hs-varid'>node</span> <span class='hs-varop'>$</span> <span class='hs-varid'>parent</span> <span class='hs-varid'>state'</span> <span class='hs-comment'>-- find result here</span>
<a name="line-53"></a>          <span class='hs-keyword'>else</span> <span class='hs-varid'>aStar'</span> <span class='hs-varid'>state'</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>c</span>    <span class='hs-comment'>-- run astar' with updated state</span>
<a name="line-54"></a>      <span class='hs-keyword'>where</span>
<a name="line-55"></a>        <span class='hs-varid'>state'</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-varop'>.</span><span class='hs-varid'>fold</span> <span class='hs-layout'>(</span><span class='hs-varid'>updateState</span> <span class='hs-varid'>h</span> <span class='hs-varid'>node</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>s</span> <span class='hs-layout'>{</span><span class='hs-varid'>closed</span><span class='hs-keyglyph'>=</span><span class='hs-varid'>closed'</span><span class='hs-layout'>,</span> <span class='hs-varid'>open</span><span class='hs-keyglyph'>=</span><span class='hs-varid'>open'</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-varid'>newNodes</span>
<a name="line-56"></a>        <span class='hs-varid'>closed'</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-varop'>.</span><span class='hs-varid'>insert</span> <span class='hs-varid'>node</span> <span class='hs-varop'>$</span> <span class='hs-varid'>closed</span> <span class='hs-varid'>s</span>      <span class='hs-comment'>-- add node to the closed list</span>
<a name="line-57"></a>        <span class='hs-varid'>newNodes</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-varop'>.</span><span class='hs-varid'>difference</span> <span class='hs-layout'>(</span><span class='hs-varid'>g</span> <span class='hs-varid'>node</span><span class='hs-layout'>)</span> <span class='hs-varid'>closed'</span> <span class='hs-comment'>-- adjacent nodes not visited</span>
<a name="line-58"></a>    <span class='hs-conid'>Nothing</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Nothing</span>                    <span class='hs-comment'>-- open queue empty, no result found</span>
<a name="line-59"></a>
<a name="line-60"></a><a name="updateState"></a><span class='hs-comment'>-- | Update the state with a new node, unless it is already in open with a</span>
<a name="line-61"></a><span class='hs-comment'>-- cheaper cost</span>
<a name="line-62"></a><span class='hs-definition'>updateState</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>WorldHolding</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- ^ Heuristic function</span>
<a name="line-63"></a>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WorldHolding</span>          <span class='hs-comment'>-- ^ Previous node</span>
<a name="line-64"></a>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WorldHolding</span>          <span class='hs-comment'>-- ^ Current node</span>
<a name="line-65"></a>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>AStarState</span>            <span class='hs-comment'>-- ^ State to update</span>
<a name="line-66"></a>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>AStarState</span>            <span class='hs-comment'>-- ^ New state</span>
<a name="line-67"></a><span class='hs-definition'>updateState</span> <span class='hs-varid'>h</span> <span class='hs-varid'>previous</span> <span class='hs-varid'>x</span> <span class='hs-varid'>state</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>pCost</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>oldCost</span>
<a name="line-68"></a>    <span class='hs-keyword'>then</span> <span class='hs-varid'>state</span> <span class='hs-comment'>-- do nothing if the path to get to the state is longer</span>
<a name="line-69"></a>    <span class='hs-keyword'>else</span> <span class='hs-varid'>state</span> <span class='hs-layout'>{</span><span class='hs-varid'>open</span><span class='hs-keyglyph'>=</span><span class='hs-varid'>open'</span><span class='hs-layout'>,</span> <span class='hs-varid'>pathCost</span><span class='hs-keyglyph'>=</span><span class='hs-varid'>pathCost'</span><span class='hs-layout'>,</span> <span class='hs-varid'>parent</span><span class='hs-keyglyph'>=</span><span class='hs-varid'>parent'</span><span class='hs-layout'>}</span>
<a name="line-70"></a>  <span class='hs-keyword'>where</span>
<a name="line-71"></a>    <span class='hs-varid'>pCost</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>fromMaybe</span> <span class='hs-num'>0</span> <span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>lookup</span> <span class='hs-varid'>previous</span> <span class='hs-varop'>$</span> <span class='hs-varid'>pathCost</span> <span class='hs-varid'>state</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- this cost</span>
<a name="line-72"></a>    <span class='hs-varid'>oldCost</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromMaybe</span> <span class='hs-varid'>pCost</span> <span class='hs-layout'>(</span><span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>lookup</span> <span class='hs-varid'>x</span> <span class='hs-varop'>$</span> <span class='hs-varid'>pathCost</span> <span class='hs-varid'>state</span><span class='hs-layout'>)</span>
<a name="line-73"></a>    <span class='hs-comment'>-- update parent if the path cost is shorter</span>
<a name="line-74"></a>    <span class='hs-varid'>parent'</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>insert</span> <span class='hs-varid'>x</span> <span class='hs-varid'>previous</span> <span class='hs-varop'>$</span> <span class='hs-varid'>parent</span> <span class='hs-varid'>state</span>
<a name="line-75"></a>    <span class='hs-comment'>-- add path lengths to pathCost (1+pathCost for previous) (M.insertWith' min)</span>
<a name="line-76"></a>    <span class='hs-varid'>pathCost'</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>insert</span> <span class='hs-varid'>x</span> <span class='hs-varid'>pCost</span> <span class='hs-varop'>$</span> <span class='hs-varid'>pathCost</span> <span class='hs-varid'>state</span>
<a name="line-77"></a>    <span class='hs-comment'>-- add new nodes with cost+heuristic to open queue (Q.insertWith min)</span>
<a name="line-78"></a>    <span class='hs-varid'>open'</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Q</span><span class='hs-varop'>.</span><span class='hs-varid'>insert</span> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><span class='hs-varid'>pCost</span> <span class='hs-varop'>+</span> <span class='hs-varid'>h</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>open</span> <span class='hs-varid'>state</span>
<a name="line-79"></a>
<a name="line-80"></a><a name="resultList"></a><span class='hs-comment'>-- | Given an final node and a list @Map@ from each node to its parent, make</span>
<a name="line-81"></a><span class='hs-comment'>-- a 'Plan'</span>
<a name="line-82"></a><span class='hs-definition'>resultList</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>WorldHolding</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-conid'>WorldHolding</span> <span class='hs-conid'>WorldHolding</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Plan</span>
<a name="line-83"></a><span class='hs-definition'>resultList</span> <span class='hs-varid'>x</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-varid'>w</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>xm</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>lookup</span> <span class='hs-varid'>x</span> <span class='hs-varid'>xm</span> <span class='hs-keyword'>of</span>
<a name="line-84"></a>    <span class='hs-conid'>Nothing</span>         <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>[]</span>
<a name="line-85"></a>    <span class='hs-conid'>Just</span> <span class='hs-varid'>x'</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-varid'>w'</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>resultList</span> <span class='hs-varid'>x'</span> <span class='hs-varid'>xm</span> <span class='hs-varop'>++</span> <span class='hs-varid'>stateTrans</span> <span class='hs-varid'>w'</span> <span class='hs-varid'>w</span> <span class='hs-num'>0</span>
<a name="line-86"></a>
<a name="line-87"></a><a name="stateTrans"></a><span class='hs-comment'>-- | Given two 'World' states and a counter (preferrably 0) make a 'Plan'</span>
<a name="line-88"></a><span class='hs-definition'>stateTrans</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>World</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>World</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Plan</span>
<a name="line-89"></a><span class='hs-definition'>stateTrans</span> <span class='hs-layout'>(</span><span class='hs-varid'>c1</span><span class='hs-conop'>:</span><span class='hs-varid'>c1s</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>c2</span><span class='hs-conop'>:</span><span class='hs-varid'>c2s</span><span class='hs-layout'>)</span> <span class='hs-varid'>col</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>compare</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span> <span class='hs-varid'>c1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span> <span class='hs-varid'>c2</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<a name="line-90"></a>    <span class='hs-conid'>LT</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-str'>"drop "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>col</span><span class='hs-keyglyph'>]</span>
<a name="line-91"></a>    <span class='hs-conid'>GT</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-str'>"pick "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>col</span><span class='hs-keyglyph'>]</span>
<a name="line-92"></a>    <span class='hs-conid'>EQ</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>stateTrans</span> <span class='hs-varid'>c1s</span> <span class='hs-varid'>c2s</span> <span class='hs-layout'>(</span><span class='hs-varid'>col</span> <span class='hs-varop'>+</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span>
<a name="line-93"></a><span class='hs-definition'>stateTrans</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>error</span> <span class='hs-str'>"stateTransition: no changes"</span>
</pre></body>
</html>
